<Window x:Class="Toucan_WPF.UIs.SpecEditor"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Toucan_WPF.UIs"
        mc:Ignorable="d" Name="self"
        Title="Spec Editor" Height="450" Width="800">
    <Window.Resources>
        <Style TargetType="TextBox">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="2"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>
        <ContextMenu x:Key="LimitContetMenu">
            <MenuItem Header="Edit Limit" Click="mi_EditLimit_Click"></MenuItem>
            <Separator></Separator>
            <MenuItem Header="GoldenSample Spec" Click="mi_GoldenSampleSpec_Click"></MenuItem>
            <MenuItem Header="Secondary Spec" Click="mi_SecondarySpec_Click"></MenuItem>
            <Separator></Separator>
            <MenuItem Header="Clear GoldenSample Spec" Click="mi_ClearGoldenSampleSpec_Click" ToolTip="Clear spec will not delete the file"></MenuItem>
            <MenuItem Header="Clear Secondary Spec" Click="mi_ClearSecondarySpec_Click" ToolTip="Clear spec will not delete the file"></MenuItem>
        </ContextMenu>
    </Window.Resources>
    <Window.InputBindings>
        <KeyBinding Gesture="Ctrl+O" Command="{Binding OpenFile}"/>
        <KeyBinding Gesture="Ctrl+S" Command="{Binding SaveFile}"/>
        <KeyBinding Gesture="Ctrl+Shift+S" Command="{Binding SaveAsFile}"/>
    </Window.InputBindings>
    <DockPanel>
        <DockPanel Margin="2" DockPanel.Dock="Top">
            <DockPanel DockPanel.Dock="Right">
                <Label Content="{Binding Spec.FilePath}" ToolTip="Spec Path"></Label>
                <Label>Grade Tag</Label>
                <TextBox MinWidth="40" Text="{Binding GradeTag, UpdateSourceTrigger=PropertyChanged}" ToolTip="Only work when Secondary Spec enabled"></TextBox>
            </DockPanel>
            <Menu>
                <MenuItem Header="_File" IsEnabled="{Binding IsEditable}">
                    <MenuItem Header="_Open" Command="{Binding OpenFile}"/>
                    <MenuItem Header="_Save" InputGestureText="Ctrl+S" Command="{Binding SaveFile}"/>
                    <MenuItem Header="Save _As..." InputGestureText="Ctrl+Shift+S" Command="{Binding SaveAsFile}"/>
                    <MenuItem Header="_Export As Csv..." Command="{Binding ExportAsCsv}" />
                    <Separator/>
                    <MenuItem Header="_Export As Report Template..." Command="{Binding ExportAsResultTemplate}" ToolTip="Tymphany Result Template, which could get the real the Item name -> Defect Code Map " />
                </MenuItem>
            </Menu>
        </DockPanel>
        <DockPanel DockPanel.Dock="Bottom">
            <TextBlock Foreground="Red" Margin="2" Text="{StaticResource SecondarySpecNote}"></TextBlock>
        </DockPanel>
        <Grid DockPanel.Dock="Top" IsEnabled="{Binding IsEditable}">
            <Grid.RowDefinitions>
                <RowDefinition Height="24"/>
                <RowDefinition Height="24"/>
                <RowDefinition Height="24"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="60"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="60"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Row="0" Grid.Column="0">Name</Label>
            <Label Grid.Row="0" Grid.Column="2">Version</Label>
            <Label Grid.Row="0" Grid.Column="4">Time</Label>
            <Label Grid.Row="1" Grid.Column="0">Part</Label>
            <Label Grid.Row="1" Grid.Column="2">Author</Label>
            <Label Grid.Row="1" Grid.Column="4">CheckValue</Label>
            <Label Grid.Row="2" Grid.Column="0">Note</Label>


            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Path=Spec.Name, Mode=OneWay}"/>
            <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding Path=Spec.Version, Mode=OneWay}"/>
            <TextBox Grid.Row="0" Grid.Column="5" Text="{Binding Path=Spec.Time, Mode=OneWay}" IsReadOnly="True" Focusable="False" Background="LightGray"/>
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Path=Spec.PartNos, Mode=OneWay}"/>
            <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding Path=Spec.Author, Mode=OneWay}" IsReadOnly="True" Focusable="False" Background="LightGray"/>
            <TextBox Grid.Row="1" Grid.Column="5" Text="{Binding Path=Spec.CheckValue, Mode=OneWay}" IsReadOnly="True" Focusable="False" Background="LightGray"/>
            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Path=Spec.Note, Mode=TwoWay}" Grid.ColumnSpan="5"/>

        </Grid>
        <DataGrid DockPanel.Dock="Bottom" IsReadOnly="{Binding IsReadOnly}" x:Name="dg_TestItems"
              AutoGenerateColumns="False" CanUserDeleteRows="True" ContextMenu="{StaticResource LimitContetMenu}"
              ItemsSource="{Binding Limits}">
            <DataGrid.Style>
                <Style></Style>
            </DataGrid.Style>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Index" Binding="{Binding Index, Mode=OneTime}" IsReadOnly="True"/>
                <DataGridTextColumn Header="Name" Binding="{Binding Limit.Name}"/>
                <DataGridTextColumn Header="Defect Code" Binding="{Binding Limit.Defect, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="USL" Binding="{Binding USL, Mode=TwoWay}"/>
                <DataGridTextColumn Header="LSL" Binding="{Binding LSL, Mode=TwoWay}"/>
                <DataGridTextColumn Header="Unit" Binding="{Binding Limit.Unit, Mode=TwoWay}"/>
                <DataGridCheckBoxColumn Header="MES" Binding="{Binding Limit.Sfc, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridCheckBoxColumn Header="Skip" Binding="{Binding Limit.Skip, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
